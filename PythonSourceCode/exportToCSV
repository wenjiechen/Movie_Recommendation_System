'''
Created on May 2, 2013

@author: WnejieChen
'''

"""
    CREATE TABLE `ratings` (
      `movie_id` int(5) NOT NULL DEFAULT '0',
      `customer_id` int(6) NOT NULL DEFAULT '0',
      `rating` int(1) NOT NULL DEFAULT '0',
      `date` date NOT NULL DEFAULT '0000-00-00',
      PRIMARY KEY  (`movie_id`,`customer_id`),
      KEY `date` (`date`),
      KEY `movie_id` (`movie_id`),
      KEY `customer_id` (`customer_id`),
      KEY `rating` (`rating`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
"""

import MySQLdb
import re
import os

def exportToCSV():
    conn = MySQLdb.connect(db='netflix', host='localhost', user='root', passwd='1234')  
    cursor = conn.cursor()
    sql_select = """SELECT customer_id,movie_id,rating 
                        INTO OUTFILE 'D:/ws2/MovieRecommonderMahout/tmp/userItemRating.csv' 
                        FIELDS TERMINATED BY ','
                        OPTIONALLY ENCLOSED BY '"'
                        LINES TERMINATED BY '\n'
                        FROM ratings
                        ORDER BY customer_id ASC"""
                        
    cursor.execute(sql_select)
    cursor.close()
                
def dictionaryTest():        
    v = {}
    print v
    
def main():
    exportToCSV()        

if __name__ == "__main__":
    main()
    